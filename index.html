<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Approval Impact Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.1.1/docx.min.js"></script>
    <style>
        * {
            scroll-behavior: smooth;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 20px;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        h1 {
            color: white;
            font-weight: 700;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .subtitle {
            color: rgba(255,255,255,0.95);
            font-size: 1.1rem;
            font-weight: 400;
        }
        
        .card-modern {
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            margin-top: 30px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card-modern:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
        }
        
        .form-label {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        
        .form-control {
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 12px 16px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            outline: none;
        }
        
        .btn-calculate {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            font-weight: 600;
            padding: 14px 32px;
            border-radius: 10px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-calculate:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }
        
        .result-icon img {
            width: 80px;
            height: 80px;
            margin-bottom: 10px;
            transition: transform 0.3s ease;
        }
        
        .result-icon:hover img {
            transform: scale(1.1);
        }
        
        .result-icon h4 {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 5px;
        }
        
        .result-icon p {
            color: #718096;
            font-size: 0.9rem;
        }
        
        .result-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-top: 20px;
            border-left: 4px solid #667eea;
        }
        
        h3 {
            color: #2d3748;
            font-weight: 700;
            margin-bottom: 30px;
        }
        
        h4, h5 {
            margin: 0;
            padding: 5px 0;
            font-weight: 600;
            color: #2d3748;
        }
        
        p {
            margin: 0;
            padding: 5px 0;
            color: #4a5568;
        }
        
        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn-action {
            padding: 12px 24px;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 10px;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        #copyBtn { 
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        #downloadImageBtn { 
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }
        #downloadMarkdownBtn { 
            background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%);
            box-shadow: 0 4px 15px rgba(241, 196, 15, 0.3);
        }
        #downloadDocxBtn { 
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }
        
        .btn-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        details summary {
            cursor: pointer;
            color: #667eea;
            font-weight: 600;
            padding: 10px;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }
        
        details summary:hover {
            background-color: #f7fafc;
        }
        
        details[open] summary {
            margin-bottom: 15px;
        }
        
        ul {
            line-height: 1.8;
        }
        
        ul li {
            color: #4a5568;
        }
        
        .note-card {
            background: linear-gradient(135deg, #e8f4f8 0%, #d4e9f3 100%);
            border-left: 4px solid #3498db;
            padding: 20px;
            border-radius: 10px;
        }
        
        .note-card p {
            margin: 0;
            font-size: 0.9em;
            color: #2d3748;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .result-icon {
                margin-bottom: 20px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn-action {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center my-4">üåç Digital Approval Impact Calculator</h1>
        <p class="text-center subtitle">Calculate how digital approval and sealing impact your organization‚Äôs sustainability and costs.</p>
        
        <!-- Methodology Section -->
        <div class="card-modern">
            <h5>üìö Methodology & Data Sources</h5>
            <details>
                <summary style="cursor: pointer; color: #3498db; font-weight: bold;">Click to view calculation methodology and sources</summary>
                <div class="mt-3">
                    <h6>How We Calculate Environmental Impact</h6>
                    <p>Our calculations are based on industry research and environmental studies:</p>
                    
                    <p><strong>Carbon Emissions (CO‚ÇÇ):</strong></p>
                    <ul>
                        <li>Value: 4.71 grams CO‚ÇÇ per sheet</li>
                        <li>Source: Environmental Paper Network (2018) - "The State of the Global Paper Industry"</li>
                    </ul>
                    
                    <p><strong>Trees Saved:</strong></p>
                    <ul>
                        <li>Value: 8,333 sheets per tree</li>
                        <li>Source: Conservatree.org and forestry industry data</li>
                    </ul>
                    
                    <p><strong>Water Conservation:</strong></p>
                    <ul>
                        <li>Value: 10 liters per sheet</li>
                        <li>Source: WWF (World Wildlife Fund) paper production studies</li>
                    </ul>
                    
                    <p><strong>Energy Savings:</strong></p>
                    <ul>
                        <li>Value: 0.5 kWh per sheet</li>
                        <li>Source: EPA Energy Star Program data</li>
                    </ul>
                    
                    <p><strong>Cost Savings:</strong></p>
                    <ul>
                        <li>Paper cost: $0.05 per sheet (commercial average)</li>
                        <li>Mailing cost: $0.50 per document (postage and handling)</li>
                    </ul>
                    
                    <p><strong>Disclaimer:</strong> These are estimates based on industry averages. Actual impacts may vary depending on paper type, manufacturing processes, and regional differences.</p>
                    
                    <p><strong>References:</strong></p>
                    <ul>
                        <li><a href="https://www.environmentalpaper.org" target="_blank">Environmental Paper Network</a></li>
                        <li><a href="https://www.conservatree.org" target="_blank">Conservatree</a></li>
                        <li><a href="https://www.worldwildlife.org" target="_blank">WWF Paper Calculator</a></li>
                        <li><a href="https://www.energystar.gov" target="_blank">EPA Energy Star</a></li>
                    </ul>
                </div>
            </details>
        </div>

        <!-- Input Section -->
        <div class="card-modern">
            <div class="mb-3">
                <label for="docVolume" class="form-label">üìÑ Total Documents Produced Annually:</label>
                <input type="number" class="form-control" id="docVolume" placeholder="Enter total document volume">
            </div>
            <div class="mb-3">
                <label for="signedDocs" class="form-label">‚úçÔ∏è Documents Needing Signature and Seal:</label>
                <input type="number" class="form-control" id="signedDocs" placeholder="Enter number of signed/sealed documents">
            </div>
            <button class="btn btn-calculate w-100" onclick="calculateImpact()">üöÄ Calculate Impact</button>
        </div>

        <!-- Results Section -->
        <div id="results" class="mt-5"></div>
    </div>

    <script>
        function calculateImpact() {
            // Get input values
            const docVolume = Number(document.getElementById("docVolume").value);
            const signedDocs = Number(document.getElementById("signedDocs").value);

            if (!docVolume || !signedDocs || docVolume < 0 || signedDocs < 0) {
                alert("Please enter valid positive numbers for both inputs.");
                return;
            }

            // Constants - Based on industry research and environmental studies
            // Sources: Environmental Paper Network, WWF, EPA Energy Star, Conservatree.org
            const co2PerSheet = 0.00471; // kg CO2 per sheet (4.71 grams)
            const sheetsPerTree = 8333; // sheets per tree (average office paper production)
            const waterPerSheet = 10; // liters of water per sheet (paper manufacturing process)
            const paperCostPerSheet = 0.05; // USD per sheet (average commercial paper cost)
            const mailCostPerDoc = 0.50; // USD per document (postage and handling estimate)
            const energyPerSheet = 0.5; // kWh energy saved per sheet (production and distribution)

            // Calculations
            const carbonSaved = signedDocs * co2PerSheet; // kg CO2
            const treesSaved = signedDocs / sheetsPerTree; // Trees
            const waterSaved = signedDocs * waterPerSheet; // Liters
            const energySaved = signedDocs * energyPerSheet; // kWh
            const totalSavings = signedDocs * paperCostPerSheet + signedDocs * mailCostPerDoc; // USD

            // Results Content
            const resultsContent = `
Our Contribution to Sustainability:

- Carbon Saved: ${carbonSaved.toFixed(2)} kg of CO‚ÇÇ
- Trees Saved: ${treesSaved.toFixed(2)}
- Water Saved: ${waterSaved.toFixed(0)} liters
- Energy Saved: ${energySaved.toFixed(2)} kWh
- Cost Savings: $${totalSavings.toFixed(2)}

SDG Contributions:
- SDG 6 (Clean Water): ${waterSaved.toFixed(0)} liters conserved
- SDG 7 (Clean Energy): Saved ${energySaved.toFixed(2)} kWh of energy
- SDG 13 (Climate Action): Avoided ${carbonSaved.toFixed(2)} kg of CO‚ÇÇ emissions
- SDG 15 (Life on Land): Preserved ${treesSaved.toFixed(2)} trees

---
Methodology: Calculations based on industry research from Environmental Paper Network, WWF, EPA Energy Star, and Conservatree.org.
These are estimates based on industry averages. Actual impacts may vary.
`;

            // Display Results
            const resultsDiv = document.getElementById("results");
            resultsDiv.innerHTML = `
                <div class="card-modern fade-in-up">
                    <h3>üå± Our Contribution to Sustainability</h3>
                    <div class="row text-center">
                        <div class="col-md-2 result-icon">
                            <img src="https://via.placeholder.com/80/3498db/ffffff?text=CO2" alt="CO2 Saved">
                            <h4>${carbonSaved.toFixed(2)} kg</h4>
                            <p>Carbon Saved</p>
                        </div>
                        <div class="col-md-2 result-icon">
                            <img src="https://via.placeholder.com/80/2ecc71/ffffff?text=Tree" alt="Trees Saved">
                            <h4>${treesSaved.toFixed(2)}</h4>
                            <p>Trees Saved</p>
                        </div>
                        <div class="col-md-2 result-icon">
                            <img src="https://via.placeholder.com/80/f1c40f/ffffff?text=Water" alt="Water Saved">
                            <h4>${waterSaved.toFixed(0)} L</h4>
                            <p>Water Saved</p>
                        </div>
                        <div class="col-md-2 result-icon">
                            <img src="https://via.placeholder.com/80/f39c12/ffffff?text=Energy" alt="Energy Saved">
                            <h4>${energySaved.toFixed(2)} kWh</h4>
                            <p>Energy Saved</p>
                        </div>
                        <div class="col-md-2 result-icon">
                            <img src="https://via.placeholder.com/80/e74c3c/ffffff?text=$" alt="Cost Savings">
                            <h4>$${totalSavings.toFixed(2)}</h4>
                            <p>Cost Savings</p>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button id="copyBtn" class="btn-action" onclick="copyResults()">üìã Copy Results</button>
                        <button id="downloadImageBtn" class="btn-action" onclick="downloadAsImage()">üñºÔ∏è Download Image</button>
                        <button id="downloadMarkdownBtn" class="btn-action" onclick="downloadAsMarkdown()">üìù Download MD</button>
                        <button id="downloadDocxBtn" class="btn-action" onclick="downloadAsDocx()">üìÑ Download Word</button>
                    </div>
                    <div class="result-card mt-4">
                        <h4>üìä SDG Contributions</h4>
                        <ul>
                            <li><strong>SDG 6 (Clean Water):</strong> ${waterSaved.toFixed(0)} liters of water conserved.</li>
                            <li><strong>SDG 7 (Clean Energy):</strong> Saved ${energySaved.toFixed(2)} kWh of energy.</li>
                            <li><strong>SDG 13 (Climate Action):</strong> Avoided ${carbonSaved.toFixed(2)} kg of CO‚ÇÇ emissions.</li>
                            <li><strong>SDG 15 (Life on Land):</strong> Preserved ${treesSaved.toFixed(2)} trees.</li>
                        </ul>
                    </div>
                    <div class="note-card mt-3">
                        <p><strong>üí° Note:</strong> These calculations are based on industry research from Environmental Paper Network, WWF, EPA Energy Star, and Conservatree.org. Values are estimates based on industry averages and may vary depending on actual paper type, manufacturing processes, and regional differences.</p>
                    </div>
                </div>
            `;

            // Store results for copying
            resultsDiv.setAttribute('data-results', resultsContent);
        }

        function copyResults() {
            const resultsDiv = document.getElementById("results");
            const resultsContent = resultsDiv.getAttribute("data-results");
            navigator.clipboard.writeText(resultsContent).then(() => {
                alert("Results copied to clipboard!");
            }).catch(err => {
                alert("Failed to copy results: " + err);
            });
        }

        function downloadAsImage() {
            const resultsDiv = document.getElementById("results");
            html2canvas(resultsDiv).then((canvas) => {
                const link = document.createElement("a");
                link.download = "sustainability_report.png";
                link.href = canvas.toDataURL("image/png");
                link.click();
            });
        }

        function downloadAsMarkdown() {
            const resultsDiv = document.getElementById("results");
            const resultsContent = resultsDiv.getAttribute("data-results");
            const markdownContent = `
# Our Contribution to Sustainability

${resultsContent.replace(/-/g, "*")}
`;
            const blob = new Blob([markdownContent], { type: "text/markdown" });
            const link = document.createElement("a");
            link.download = "sustainability_report.md";
            link.href = URL.createObjectURL(blob);
            link.click();
        }

        function downloadAsDocx() {
            const { Document, Packer, Paragraph, TextRun } = window.docx;

            const resultsDiv = document.getElementById("results");
            const resultsContent = resultsDiv.getAttribute("data-results");

            const doc = new Document({
                sections: [
                    {
                        children: [
                            new Paragraph({
                                children: [
                                    new TextRun("Our Contribution to Sustainability").bold().size(24),
                                ],
                            }),
                            ...resultsContent.split("\n").map((line) =>
                                new Paragraph({
                                    children: [new TextRun(line)],
                                })
                            ),
                        ],
                    },
                ],
            });

            Packer.toBlob(doc).then((blob) => {
                const link = document.createElement("a");
                link.href = URL.createObjectURL(blob);
                link.download = "sustainability_report.docx";
                link.click();
            });
        }
    </script>
</body>
</html>
